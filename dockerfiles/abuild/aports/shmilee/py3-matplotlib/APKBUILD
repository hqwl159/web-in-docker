# Contributor: Isaac Dunham <ibid.ag@gmail.com>
# Maintainer: shmilee <shmilee.zju@gmail.com>

pkgname=py3-matplotlib
_pkgname=matplotlib
pkgver=2.1.1
pkgrel=1
pkgdesc="A python plotting library, making publication quality plotss"
url="http://matplotlib.org"
arch="all"
license="custom"
depends="python3 py3-numpy python3-tkinter py3-dateutil py3-parsing py3-tz py3-cycler"
makedepends="python3-dev gfortran py-numpy-dev freetype-dev libpng-dev tk-dev
    py-setuptools"
subpackages="$pkgname-doc $pkgname-tests"
source="$_pkgname-$pkgver.tar.gz::https://github.com/matplotlib/$_pkgname/archive/v$pkgver.tar.gz"
builddir="$srcdir/$_pkgname-$pkgver"

build() {
    cd "$builddir"
    python3 setup.py build || return 1
}

package() {
    cd "$builddir"

    python3 setup.py install --prefix=/usr --root="$pkgdir" || return 1
    install -m755 -d "$pkgdir"/usr/share/licenses/custom/$pkgname
    install -m644 LICENSE/* "$pkgdir"/usr/share/licenses/custom/$pkgname/
}

tests() {
    pkgdesc="$pkgdesc (tests)"
    arch="noarch"
    depends="$depends py-nose"
    local sitepath="$(python3 -c 'import site; print(site.getsitepackages()[0])')/$_pkgname"

    mkdir -p "$subpkgdir"$sitepath
    mv "$pkgdir"$sitepath/testing "$subpkgdir"$sitepath/
}

sha512sums="ccfb7d9496cb8e160a22adfae7ec6edf56bf65d24d38d9a24767b8f10074a006509e789f8b270da0cedee77ed4a98642a29d2d351c520e029d4680ce6ea713cf  matplotlib-2.1.1.tar.gz"
